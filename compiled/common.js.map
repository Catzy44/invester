{"version":3,"file":"common.js","names":["cities","AUTH_KEY","modular","panels","window","onload","console","log","query","location","search","substring","qs","parse_query_string","switchToDevServerURL","setTimeout","recalculateElements","recalculateTopRightStats","sprawdzZmiany","fet","then","res","byid","id","find","element","catch","err","Dialog","build","inner","title","draw","showMessagesPanel","isMobile","innerHeight","innerWidth","zapisy","miejsceId","openChetni","wiadomosci","ucz","getZaznaczeniUczestnicy","openWiadomosci","parseInt","insertAfter","newNode","existingNode","parentNode","insertBefore","nextSibling","findPlaceDialog","div","crEl","box","centered","t","style","textAlign","tab","cells","inp","placeholder","onchange","method","body","JSON","stringify","name","value","season","getActiveSeason","i","cell","row","innerHTML","address","onclick","zmienAktywneMiejsce","classList","add","remove","oninput","onpaste","focus","push","wyswietlPopupWyszukiwanieUczestnikow","r","wywalPopup","document","createElement","appendChild","getElementById","input","szukajUczestnika","el","info","contains","miejsceNazwa","imie","nazwisko","uczestnikId","wybierzUczestnika","centerUserRow","firstChild","spin","boo","objecttransfers","formularze","getAktywneMiejsce","miejsce","minWidth","minHeight","center_div","marginBottom","formuls","loadForms","succ","fail","req","forms","forEach","form","hh","margin","left","position","top","right","ev","paragrafy","applyParagrafDatatransferData","object","ondragstart","drag","Math","floor","random","dataTransfer","setData","RESTObjectToRelativeSelfLink","ondragover","preventDefault","ondrop","stary_formularz_link","getData","stary_paragraf_link","childElementCount","elem","oldparent","parentElement","splice","data","error","parags","length","pu","par","d","dropped_formularz_link","dropped_paragraf_link","pen","paddingTop","dialog","parent","target","jsondata","parse","e","type","sel","additional","parTypes","key","map","opt","selected","gen","buildParagraphAdditionalOpts","b","s","patch","hat_link","close","cb","get","draggable","botBtns","c","request","ad","func","provdata","hat_id","refr","adder","fill","tagName","checked","area","bind","grupy","hat_embedded","showh","m","Map","ch","set","includes","v","k","width","fil","ar","check","te","chkbx","ckbx"],"sources":["../uncompiled/common.js"],"sourcesContent":["let cities = null;\nlet AUTH_KEY = \"\";\nlet modular = {panels:{}};\n\nwindow.onload = function() {\n\tconsole.log(\"Meow!\");\n\n\tconst query = window.location.search.substring(1);\n\tconst qs = parse_query_string(query);\n\tif('dev' in qs) {\n\t\tswitchToDevServerURL()\n\t}\n\n\tsetTimeout(function(){\n\t\trecalculateElements();\n\t\trecalculateTopRightStats();\n\t\tsprawdzZmiany();\n\t}, 50);\n\n\tfet(\"miasta\").then(res=>{\n\t\tcities = res\n\t\tcities.byid = function(id) {\n\t\t\treturn cities.find(function(element) { return element[\"id\"] == id});\n\t\t}\n\t}).catch(err=>{\n\t\tDialog.build().inner(\"Niepowodzenie wczytywania danych: miasta<br>program może nie działać prawidłowo\").title(\"Wystąpił problem\").draw();\n\t})\n\tmodular.showMessagesPanel()\n\n\twindow.isMobile = window.innerHeight > window.innerWidth\n}\n\nfunction zapisy(miejsceId) {\n\tmodular.openChetni(miejsceId);\n}\n\nfunction wiadomosci() {\n\t//const uid = zaznaczo\n\tconst ucz = getZaznaczeniUczestnicy();\n\tif(ucz == null || ucz == '') {\n\t\treturn;\n\t}\n\tmodular.openWiadomosci(parseInt(ucz));\n}\n\nfunction insertAfter(newNode, existingNode) {\n\texistingNode.parentNode.insertBefore(newNode, existingNode.nextSibling);\n}\n\nfunction findPlaceDialog() {\n\tlet div = crEl(\"div\");\n\tlet box = Dialog.build().inner(div).centered(false).draw(true);\n\n\tlet t = div.crEl(\"div\",null,\"Wyszukaj miejsce w bazie danych<br>po nazwie lub adresie<br>Kliknij wiersz aby przejść\");\n\tt.style.textAlign = \"center\";\n\n\tlet tab = div.crEl(\"table\",\"findPlaceTable\");\n\n\tlet cells = [];\n\n\tlet inp = tab.crEl(\"tr\").crEl(\"td\").crEl(\"input/text\");\n\tinp.placeholder=\"Wyszukaj...\";\n\tinp.onchange = function(){\n\t\tfet(\"miejsca/search\",{method:\"POST\",body:JSON.stringify({name:inp.value,season:getActiveSeason()})}).then(res=>{\n\t\t\tfor(let i = 0; i < 10; i++) {\n\t\t\t\tlet cell = cells[i];\n\t\t\t\tif(res != null && res[i] != null) {\n\t\t\t\t\tlet row = res[i];\n\t\t\t\t\tcell.innerHTML = row.name+\" \"+row.address;\n\t\t\t\t\tcell.onclick = function() {\n\t\t\t\t\t\tzmienAktywneMiejsce(row[\"id\"],null);\n\t\t\t\t\t}\n\t\t\t\t\tcell.classList.add(\"wyszukiwanieUczestnikaWyniki\");\n\t\t\t\t} else {\n\t\t\t\t\tcell.innerHTML = \"\";\n\t\t\t\t\tcell.onclick = null;\n\t\t\t\t\tcell.classList.remove(\"wyszukiwanieUczestnikaWyniki\");\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\tinp.oninput = inp.onchange;\n\tinp.onpaste = inp.onchange;\n\tsetTimeout(()=>{\n\t\tinp.focus();\n\t},500)\n\n\tfor(let i = 0; i < 10; i++) {\n\t\tlet row = tab.crEl(\"tr\");\n\t\tlet cell = row.crEl(\"td\");\n\t\tcells.push(cell);\n\t}\n}\n\nfunction wyswietlPopupWyszukiwanieUczestnikow() {\n\tlet r = '';\n\tr += '<center>';\n\tr += '\t<b>Wyszukaj uczestnika w bazie danych</b></br>';\n\tr += '\t<b>po imieniu, nazwisku lub telefonie.</b></br>';\n\tr += '\t<b>Kliknij na uczestnika aby przejść do miejsca.</b></br>';\n\tr += '\t</br>';\n\tr += '\t<div style=\"\">';\n\tr += '\t\t<table id=\"szukajUczestnikowTable\">';\n\tr += '\t\t</table>';\n\tr += '\t</div>';\n\tr += '</center>';\n\twywalPopup(r);\n\n\t//pola wyboru znalezionych\n\tlet cells = [];\n\tfor(let i = 0; i < 10; i++) {\n\t\tlet cell = document.createElement('td');\n\t\tcell.style=\"width:300px;height:28px;\";\n\n\t\tlet row = document.createElement('tr');\n\t\trow.appendChild(cell);\n\n\t\tcells.push(cell);\n\t\tdocument.getElementById(\"szukajUczestnikowTable\").appendChild(row);\n\t}\n\n\t//szukajka\n\tlet input = document.createElement('input');\n\tlet cell = document.createElement('td');\n\tlet row = document.createElement('tr');\n\n\tinput.placeholder=\"Wyszukaj...\";\n\tinput.style=\"width:100%;height:100%;\";\n\tinput.onchange = function(){\n\t\tszukajUczestnika(\"wyszukiwanieUczestnikaPoImieniuNazwiskuTelefonie\",input.value,cells,function(el,info){\n\t\t\tif(info == null) {\n\t\t\t\tif(el.classList.contains('wyszukiwanieUczestnikaWyniki')) {el.classList.remove('wyszukiwanieUczestnikaWyniki');}\n\t\t\t\tel.innerHTML = \"\";\n\t\t\t} else {\n\t\t\t\tif(!el.classList.contains('wyszukiwanieUczestnikaWyniki')) {el.classList.add('wyszukiwanieUczestnikaWyniki');}\n\t\t\t\tel.innerHTML = \"[\"+info.miejsceNazwa+\"] \"+info.imie+\" \"+info.nazwisko;\n\t\t\t}\n\t\t},function(el,info){\n\t\t\tlet uczestnikId = info['id'];\n\t\t\tzmienAktywneMiejsce(info['miejsce'],function (){\n\t\t\t\twybierzUczestnika(uczestnikId);\n\t\t\t\tcenterUserRow(uczestnikId);\n\t\t\t});\n\t\t});\n\t}\n\tinput.oninput = input.onchange;\n\tinput.onpaste = input.onchange;\n\n\tcell.style=\"width:300px;height:28px;\";\n\n\tcell.appendChild(input);\n\trow.appendChild(cell);\n\t//document.getElementById(\"szukajUczestnikowTable\").appendChild(row);\n\tdocument.getElementById(\"szukajUczestnikowTable\").insertBefore(row,document.getElementById(\"szukajUczestnikowTable\").firstChild);\n\n\tinput.focus();\n}\n\nfunction spin(element,boo) {\n\tif(boo) {\n\t\telement.classList.add(\"spinning\");\n\t} else {\n\t\telement.classList.remove(\"spinning\");\n\t}\n}\n\nlet objecttransfers = [];\nfunction formularze() {\n\tlet miejsceId = getAktywneMiejsce();\n\n\tfet(\"miejsca/\"+miejsceId,{method:\"GET\"}).then(miejsce=>{\n\n\t\tlet el = crEl(\"div\",\"set_password\");\n\t\tel.style.minWidth = \"190px\";\n\t\tlet box = Dialog.build().inner(el).centered(true).title(\"Edycja formularzy\").draw();\n\t\tbox.element.style.minWidth=\"600px\";\n\t\tbox.element.style.minHeight=\"400px\";\n\n\t\tconst center_div = el.crEl(\"div\");\n\t\tcenter_div.style.textAlign = \"center\";\n\t\tcenter_div.style.marginBottom = \"5px\";\n\n\t\tcenter_div.crEl(\"span\",null,\"Miejsce: <i>\"+miejsce['nazwa']+\"</i> <br>\");\n\n\t\tcenter_div.crEl(\"span\",null,\"formularze\");\n\n\t\tlet formuls = el.crEl(\"div\",\"formularze\");\n\t\tconst loadForms = function(succ,fail){//\"miejsca/\"+miejsceId+\"/formularze\"//\"?projection=linki\"\n\t\t\treq([miejsce,\"formularze\"],\"GET/MBED\",null,(forms)=> {\n\t\t\t\tformuls.innerHTML = \"\";\n\t\t\t\tif(forms == null) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tforms.forEach((form)=> {//lista popupów/formularzy dla miejsca\n\t\t\t\t\tlet div = formuls.crEl(\"div\", \"form\");\n\t\t\t\t\tdiv.crEl(\"span\", null, form['name']);\n\n\t\t\t\t\tlet hh = div.crEl(\"span\",\"clickable\",\"aktywuj\");\n\t\t\t\t\thh.style.margin.left = \"5px\";\n\t\t\t\t\thh.style.position = \"absolute\";\n\t\t\t\t\thh.style.top = \"2px\";\n\t\t\t\t\thh.style.right = \"5px\";\n\t\t\t\t\thh.onclick = function(ev) {\n\n\t\t\t\t\t}\n\n\t\t\t\t\tlet paragrafy = div.crEl(\"div\", \"paragrafy\");\n\n\t\t\t\t\t//const popupId = parseInt(form['id']);\n\n\t\t\t\t\tfunction applyParagrafDatatransferData(element,object) {\n\t\t\t\t\t\telement.ondragstart = function drag(ev) {\n\t\t\t\t\t\t\t//0->1000\n\t\t\t\t\t\t\tlet i = Math.floor(Math.random() * 1001);\n\t\t\t\t\t\t\tobjecttransfers[i] = element;\n\t\t\t\t\t\t\tev.dataTransfer.setData(\"div\", i+\"\");\n\t\t\t\t\t\t\tev.dataTransfer.setData(\"paragraf\", RESTObjectToRelativeSelfLink(object));\n\t\t\t\t\t\t\tev.dataTransfer.setData(\"formularz\", RESTObjectToRelativeSelfLink(form));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\n\t\t\t\t\tdiv.ondragover = function (ev) {\n\t\t\t\t\t\tev.preventDefault()\n\t\t\t\t\t}\n\t\t\t\t\tdiv.ondrop = (ev) => {\n\t\t\t\t\t\tev.preventDefault();\n\t\t\t\t\t\tlet stary_formularz_link = ev.dataTransfer.getData(\"formularz\");\n\t\t\t\t\t\tlet stary_paragraf_link = ev.dataTransfer.getData(\"paragraf\");\n\n\t\t\t\t\t\tlet i = parseInt(ev.dataTransfer.getData(\"div\"));\n\t\t\t\t\t\tif (paragrafy.childElementCount === 0) {\n\t\t\t\t\t\t\tparagrafy.innerHTML = \"\";//remove [Pusto]\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tlet elem = objecttransfers[i];\n\t\t\t\t\t\t//debugger;\n\t\t\t\t\t\tlet oldparent = elem.parentElement;\n\n\t\t\t\t\t\tif (stary_formularz_link === RESTObjectToRelativeSelfLink(form)) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (oldparent.childElementCount === 0) {\n\t\t\t\t\t\t\toldparent.innerHTML = \"[Pusto]\";//add [Pusto]\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tobjecttransfers.splice(i, 1);\n\n\t\t\t\t\t\t//przerzucanie paragrafów POMIĘDZY formularzami\n\t\t\t\t\t\treq(stary_paragraf_link, \"PATCH\", {\"formularz\": form,\"ord\":99}, (data) => {\n\t\t\t\t\t\t\tparagrafy.appendChild(elem);\n\t\t\t\t\t\t}, (err) => {\n\t\t\t\t\t\t\tconsole.error(err);\n\t\t\t\t\t\t\tloadForms();\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\t//paragrafy danego popupu\n\t\t\t\t\tlet parags = form['paragrafy'];\n\t\t\t\t\treq([form,\"paragrafy\"],\"GET/MBED\",null,(parags)=>{\n\t\t\t\t\t\tif (parags == null || parags.length == 0) {\n\t\t\t\t\t\t\tconst pu = paragrafy.crEl(\"div\");\n\t\t\t\t\t\t\tpu.innerHTML = \"[Pusto]\";\n\t\t\t\t\t\t\tpu.style.textAlign = \"center\";\n\t\t\t\t\t\t\tpu.style.marginBottom = \"3px\";\n\t\t\t\t\t\t}\n\t\t\t\t\t\tparags.forEach((par)=> {\n\t\t\t\t\t\t\tlet d = paragrafy.crEl(\"div\", \"paragraf\");\n\t\t\t\t\t\t\td.ondragover = function (ev) {\n\t\t\t\t\t\t\t\tev.preventDefault()\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\td.ondrop = function(ev) {\n\t\t\t\t\t\t\t\tev.preventDefault();\n\t\t\t\t\t\t\t\tconst dropped_formularz_link = ev.dataTransfer.getData(\"formularz\");\n\t\t\t\t\t\t\t\tconst dropped_paragraf_link = ev.dataTransfer.getData(\"paragraf\");\n\n\t\t\t\t\t\t\t\tlet i = parseInt(ev.dataTransfer.getData(\"div\"));\n\t\t\t\t\t\t\t\tlet elem = objecttransfers[i];\n\n\t\t\t\t\t\t\t\tif(dropped_formularz_link !== RESTObjectToRelativeSelfLink(form)) {\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t//\"paragrafy/\"+droppedParagrafId+\"/order_after/\"+par['id']\n\t\t\t\t\t\t\t\treq([dropped_paragraf_link,\"order_after\",par[\"_id\"]],\"GET\",null,(r)=>{\n\t\t\t\t\t\t\t\t\tapplyParagrafDatatransferData(elem,r);\n\t\t\t\t\t\t\t\t\tinsertAfter(elem,d);\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tlet pen = d.crEl(\"i\", [\"fa-solid\", \"fa-pen\", \"fa-xs\"]);\n\t\t\t\t\t\t\tpen.style.paddingTop = \"7px\";\n\t\t\t\t\t\t\tpen.onclick = function(ev) {//edycja paragrafu\n\t\t\t\t\t\t\t\tlet el = crEl(\"div\", \"flex_col_dial\");\n\t\t\t\t\t\t\t\tlet dialog = Dialog.build().inner(el).parent(ev.target).title(\"edycja paragrafu\").draw();\n\t\t\t\t\t\t\t\tlet inp = el.crEl(\"input/text\");\n\t\t\t\t\t\t\t\tinp.placeholder = \"Nazwa...\";\n\t\t\t\t\t\t\t\tinp.value = par[\"name\"];\n\n\t\t\t\t\t\t\t\tlet jsondata = null;\n\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\tjsondata = JSON.parse(par[\"data\"]);\n\t\t\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\t\t\tconsole.error(e);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tlet type = parseInt(par[\"type\"]);\n\n\t\t\t\t\t\t\t\tlet sel = el.crEl(\"select\");\n\t\t\t\t\t\t\t\tlet additional = el.crEl(\"div\", \"parTypeAddsCont\");\n\n\t\t\t\t\t\t\t\tparTypes.forEach((value, key, map) => {\n\t\t\t\t\t\t\t\t\tif (value == null) return;\n\t\t\t\t\t\t\t\t\tlet opt = sel.crEl(\"option\", null, value);\n\t\t\t\t\t\t\t\t\topt.value = key;//for later\n\t\t\t\t\t\t\t\t\tif(type === key) {\n\t\t\t\t\t\t\t\t\t\topt.selected = \"true\";\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\tlet gen = buildParagraphAdditionalOpts(type,additional,jsondata,miejsceId);\n\n\t\t\t\t\t\t\t\tlet b = el.crEl(\"input/button\", null, \"Zapisz\");\n\t\t\t\t\t\t\t\tb.onclick = function () {\n\t\t\t\t\t\t\t\t\tlet s = inp.value;\n\t\t\t\t\t\t\t\t\tlet type = sel.value;\n\n\t\t\t\t\t\t\t\t\tlet data = gen[\"f\"]();\n\n\t\t\t\t\t\t\t\t\tlet patch = {\"type\":type,\"data\":JSON.stringify(data)};\n\n\t\t\t\t\t\t\t\t\tif(inp.value !== par[\"name\"]) {\n\t\t\t\t\t\t\t\t\t\tpatch[\"name\"] = inp.value;\n\t\t\t\t\t\t\t\t\t}\n\n\n\t\t\t\t\t\t\t\t\treq(hat_link(par,\"self\"),\"PATCH\", patch, ()=> {\n\t\t\t\t\t\t\t\t\t\tdialog.close();\n\t\t\t\t\t\t\t\t\t\tloadForms();\n\t\t\t\t\t\t\t\t\t}, null);\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tlet cb = el.crEl(\"input/button\", null, \"Usuń\");\n\t\t\t\t\t\t\t\tcb.onclick = function () {\n\t\t\t\t\t\t\t\t\treq(\"paragrafy/\"+par[\"id\"],\"DELETE\", null, ()=> {\n\t\t\t\t\t\t\t\t\t\tdialog.close();\n\t\t\t\t\t\t\t\t\t\tloadForms();\n\t\t\t\t\t\t\t\t\t}, null);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\td.crEl(\"span\", \"paragraf_nazwa\", parTypes.get(parseInt(par['type'])));\n\t\t\t\t\t\t\td.crEl(\"span\", \"paragraf_tytul\", par['name']);\n\n\t\t\t\t\t\t\td.draggable = true;\n\t\t\t\t\t\t\tapplyParagrafDatatransferData(d,par);\n\t\t\t\t\t\t});\n\t\t\t\t\t},(err)=>{\n\n\t\t\t\t\t});\n\n\t\t\t\t\tlet botBtns = div.crEl(\"div\", \"formBtns\");\n\t\t\t\t\tlet pen = botBtns.crEl(\"i\", [\"fa-solid\", \"fa-pen\", \"fa-xs\"]);\n\t\t\t\t\tpen.style.paddingTop = \"7px\";\n\t\t\t\t\tpen.onclick = function (ev) {//edycja formularza\n\t\t\t\t\t\tlet el = crEl(\"div\", \"edit_form\");\n\t\t\t\t\t\tlet dialog = Dialog.build().inner(el).parent(ev.target).title(\"edycja formularza\").draw();\n\n\t\t\t\t\t\tlet inp = el.crEl(\"input/text\", null, form['name']);\n\t\t\t\t\t\tlet b = el.crEl(\"input/button\", null, \"Zapisz zmiany\");\n\t\t\t\t\t\tb.onclick = function () {\n\t\t\t\t\t\t\tlet s = inp.value;\n\t\t\t\t\t\t\treq(form,\"PATCH\", \"name=\" + s, ()=> {\n\t\t\t\t\t\t\t\tdialog.close();\n\t\t\t\t\t\t\t\tloadForms();\n\t\t\t\t\t\t\t}, null);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tlet c = el.crEl(\"input/button\", null, \"Usuń formularz\");\n\t\t\t\t\t\tc.onclick = function () {\n\t\t\t\t\t\t\trequest(form, \"DELETE\", null, ()=> {\n\t\t\t\t\t\t\t\tdialog.close();\n\t\t\t\t\t\t\t\tloadForms();\n\t\t\t\t\t\t\t}, null);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t//dodawanie paragrafu\n\t\t\t\t\tlet ad = botBtns.crEl(\"i\", [\"fa-solid\", \"fa-plus\"]);\n\t\t\t\t\tad.onclick = function (ev) {\n\t\t\t\t\t\tlet el = crEl(\"div\", \"flex_col_dial\");\n\t\t\t\t\t\tlet dialog = Dialog.build().inner(el).parent(ev.target).title(\"dodawanie paragrafu\").draw();\n\t\t\t\t\t\tlet inp = el.crEl(\"input/text\");\n\t\t\t\t\t\tinp.placeholder = \"Nazwa...\";\n\n\t\t\t\t\t\tlet sel = el.crEl(\"select\");\n\t\t\t\t\t\tlet additional = el.crEl(\"div\", \"parTypeAddsCont\");\n\n\t\t\t\t\t\tparTypes.forEach((value, key, map) => {\n\t\t\t\t\t\t\tif (value == null) return;\n\t\t\t\t\t\t\tlet opt = sel.crEl(\"option\", null, value);\n\t\t\t\t\t\t\topt.value = key;//for later\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\t//let map = [];\n\t\t\t\t\t\tlet type = 1;\n\n\t\t\t\t\t\tlet b = el.crEl(\"input/button\", null, \"Utwórz\");\n\n\t\t\t\t\t\tconst func = (ev) => {\n\t\t\t\t\t\t\ttype = parseInt(sel.value);\n\t\t\t\t\t\t\tadditional.innerHTML = \"\";\n\n\t\t\t\t\t\t\tlet provdata = {};\n\t\t\t\t\t\t\tlet gen = buildParagraphAdditionalOpts(type,additional,provdata,miejsceId);\n\n\t\t\t\t\t\t\tb.onclick = function () {\n\t\t\t\t\t\t\t\tlet s = inp.value;\n\n\t\t\t\t\t\t\t\tlet data = (gen == null || gen[\"f\"] == null) ? null : gen[\"f\"]();\n\n\t\t\t\t\t\t\t\tconst patch = {\n\t\t\t\t\t\t\t\t\t\"formularz\":hat_id(hat_link(form,\"self\")),\n\t\t\t\t\t\t\t\t\t\"type\" : type,\n\t\t\t\t\t\t\t\t\t\"name\" : s,\n\t\t\t\t\t\t\t\t\t\"data\" : data\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\treq(\"paragrafy\", \"POST\", patch, ()=> {\n\t\t\t\t\t\t\t\t\tdialog.close();\n\t\t\t\t\t\t\t\t\tloadForms();\n\t\t\t\t\t\t\t\t}, null);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\t\t\t\t\t\tsel.onchange = func;\n\t\t\t\t\t\tfunc();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tif(succ != null)\n\t\t\t\t\tsucc();\n\t\t\t},fail);\n\t\t}\n\n\t\t//ODŚWIEŻ LISTĘ FORMULARZY DLA MIEJSCA\n\t\tlet refr = center_div.crEl(\"i\",[\"fa-solid\",\"fa-arrows-rotate\"]);\n\t\trefr.onclick = ()=>{\n\t\t\t/*box.close();\n\t\t\tformularze();*/\n\t\t\tspin(refr,true);\n\t\t\tloadForms(()=>{\n\t\t\t\tspin(refr,false);\n\t\t\t});\n\t\t}\n\n\t\t//DODAJ NOWY FORMULARZ DLA MIEJSCA\n\t\tlet adder = center_div.crEl(\"i\",[\"fa-solid\",\"fa-plus\"]);\n\t\tadder.onclick = (ev)=> {\n\t\t\tlet el = crEl(\"div\",\"new_form\");\n\t\t\tlet dialog = Dialog.build().inner(el).parent(ev.target).title(\"nowy formularz\").draw();\n\t\t\tlet inp = el.crEl(\"input/text\");\n\t\t\tinp.placeholder = \"Nazwa...\";\n\t\t\tlet b = el.crEl(\"input/button\",null,\"Dodaj\");\n\n\t\t\tb.onclick = function() {\n\t\t\t\tlet s = inp.value;\n\t\t\t\treq(\"formularze\",\"PUT\",{\"name\":s,\"miejsce\":\"miejsca/\"+miejsceId},function(){\n\t\t\t\t\tdialog.close();\n\t\t\t\t\tloadForms();\n\t\t\t\t},null);\n\t\t\t}\n\t\t}\n\n\t\tloadForms();\n\n\t});\n}\n\nfunction buildParagraphAdditionalOpts(type,additional,provdata,miejsceId) {\n\tlet gen = {};\n\n\tlet fill = function (el, s) {\n\t\t//return s == null ? \"\" : s;\n\t\tif(s == null) {\n\t\t\treturn;\n\t\t}\n\t\tif (el.tagName === \"INPUT\" && el.type === \"checkbox\") {\n\t\t\tel.checked = s;\n\t\t} else if (el.tagName === \"INPUT\" && (el.type === \"number\" || el.type === \"text\")) {\n\t\t\tel.value = s;\n\t\t} else if (el.tagName === \"TEXTAREA\") {\n\t\t\tel.value = s;\n\t\t} else if (el.tagName === \"SELECT\") {\n\t\t\tel.value = s;\n\t\t}\n\t}\n\n\tswitch (type) {\n\t\tcase 1:\n\t\t\tlet area = additional.crEl(\"textarea\");\n\t\t\tarea.placeholder = \"Dowolny tekst...\\nZmienne: [DATA] [KONTO]\";\n\t\t\tfill(area,provdata[\"content\"]);\n\n\t\t\tgen[\"f\"] = function(area) {\n\t\t\t\tlet data = {};\n\t\t\t\tdata[\"content\"] = area.value;\n\t\t\t\treturn data;\n\t\t\t}.bind(this,area);\n\t\t\tbreak;\n\t\tcase 4:\n\t\t\tfet(\"miejsca/\"+miejsceId+\"/grupy\").then(res=> {\n\t\t\t\tlet grupy = hat_embedded(res);\n\n\t\t\t\tlet div = additional.crEl(\"div\");\n\t\t\t\tlet showh = div.crEl(\"input/checkbox\");\n\t\t\t\tfill(showh,provdata[\"showhours\"]);\n\n\t\t\t\tdiv.crEl(\"span\", null, \"Wyświetl godziny\");\n\t\t\t\tadditional.crEl(\"span\", null, \"Dostępne grupy:\");\n\t\t\t\tlet m = new Map();\n\t\t\t\tgrupy.forEach((d) => {\n\t\t\t\t\tlet div = additional.crEl(\"div\");\n\n\t\t\t\t\tconst ch = div.crEl(\"input/checkbox\");\n\t\t\t\t\tm.set(d['id'], ch);\n\t\t\t\t\tch.checked = provdata[\"groups\"] != null && provdata[\"groups\"].includes(d['id']);\n\n\t\t\t\t\tdiv.crEl(\"span\", null, d['nazwa']);\n\t\t\t\t});\n\n\n\t\t\t\tgen['f'] = function(showh,m) {\n\t\t\t\t\tlet data = {};\n\n\t\t\t\t\tdata[\"showhours\"] = showh.checked;\n\t\t\t\t\tdata[\"groups\"] = [];\n\t\t\t\t\tm.forEach((v, k) => {\n\t\t\t\t\t\tif (v.checked) {\n\t\t\t\t\t\t\tdata[\"groups\"].push(k);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\treturn data;\n\t\t\t\t}.bind(this,showh,m);\n\t\t\t});\n\t\t\tbreak;\n\t\tcase 5://harmonogram opłat\n\t\t\tfet(\"miejsca/\"+miejsceId+\"/grupy\").then(res=>{\n\t\t\t\tlet grupy = hat_embedded(res);\n\t\t\t\tdebugger;\n\n\t\t\t\tadditional.crEl(\"span\", null, \"wybór grupy...\");\n\t\t\t\tlet sel = additional.crEl(\"select\");\n\t\t\t\tgrupy.forEach((d) => {\n\t\t\t\t\tlet opt = sel.crEl(\"option\", null, d['nazwa']);\n\t\t\t\t\topt.value = hat_id(hat_link(d,\"self\"));//for later\n\t\t\t\t});\n\t\t\t\tfill(sel,provdata[\"group\"]);\n\n\n\t\t\t\tgen[\"f\"] = function(sel) {\n\t\t\t\t\tlet data = {};\n\t\t\t\t\tdata[\"group\"] = sel.value;\n\t\t\t\t\treturn data;\n\t\t\t\t}.bind(this,sel);\n\t\t\t});\n\t\t\tbreak;\n\t\tcase 6://płatność indywidualna\n\t\t\tlet div = additional.crEl(\"div\");\n\t\t\tdiv.crEl(\"span\", null, \"Cena za 1 zajęcia: \");\n\t\t\tlet inp = div.crEl(\"input/number\", null, \"0\");\n\t\t\tinp.style.width = \"70px\";\n\t\t\tfill(inp,provdata[\"price\"]);\n\n\t\t\tgen[\"f\"] = function(inp) {\n\t\t\t\tlet data = {};\n\t\t\t\tdata[\"price\"] = parseInt(inp.value);\n\t\t\t\treturn data;\n\t\t\t}.bind(this,inp);\n\t\t\tbreak;\n\t\tcase 7://do akceptacji\n\t\t\tlet fil = additional.crEl(\"div\");\n\t\t\tlet i = fil.crEl(\"input/checkbox\", null);\n\t\t\tfil.crEl(\"span\", null, \"Obowiązkowy\");\n\t\t\tlet ar = additional.crEl(\"textarea\");\n\t\t\tar.placeholder = \"Dowolny tekst...\\nZmienne: [DATA] [KONTO]\";\n\t\t\tfill(i,provdata[\"required\"]);\n\t\t\tfill(ar,provdata[\"content\"]);\n\n\t\t\tgen[\"f\"] = function(area,check) {\n\t\t\t\tlet data = {};\n\t\t\t\tdata[\"content\"] = area.value;\n\t\t\t\tdata[\"required\"] = check.checked;\n\t\t\t\treturn data;\n\t\t\t}.bind(this,ar,i);\n\t\t\tbreak;\n\t\tcase 8://kod sms\n\t\t{\n\t\t\tlet div = additional.crEl(\"div\");\n\t\t\tdiv.crEl(\"span\", null, \"Treść na przycisku: \");\n\t\t\tlet inp = div.crEl(\"input/text\", null, \"Wyślij kod\");\n\t\t\tinp.style.width = \"100px\";\n\t\t\tfill(inp,provdata[\"buttontext\"]);\n\n\t\t\tgen[\"f\"] = function(te) {\n\t\t\t\tlet data = {};\n\t\t\t\tdata[\"buttontext\"] = te.value;\n\t\t\t\treturn data;\n\t\t\t}.bind(this,inp);\n\t\t}\n\t\t\tbreak;\n\t\tcase 9://MAIL\n\t\t{\n\t\t\tlet ar = additional.crEl(\"textarea\");\n\t\t\tar.placeholder = \"Treść wysyłanego e-maila\";\n\t\t\tadditional.crEl(\"span\", null, \"Dostępne zmienne:<br>\" +\n\t\t\t\t\"[dziecko-imie][dziecko-nazw][dziecko-tel][dziecko-email]<br>\" +\n\t\t\t\t\"[rodzic-imie][rodzic-nazw][rodzic-tel][rodzic-email]<br>\" +\n\t\t\t\t\"[znak][data]\");\n\t\t\tlet div = additional.crEl(\"div\");\n\t\t\tlet chkbx = div.crEl(\"input/checkbox\");\n\t\t\tdiv.crEl(\"span\", null, \"Załącz umowę\");\n\t\t\tfill(chkbx,provdata[\"attach\"]);\n\t\t\tfill(ar,provdata[\"content\"]);\n\n\t\t\tgen[\"f\"] = function(area,ckbx) {\n\t\t\t\tlet data = {};\n\t\t\t\tdata[\"content\"] = area.value;\n\t\t\t\tdata[\"attach\"] = ckbx.checked;\n\t\t\t\treturn data;\n\t\t\t}.bind(this,ar,chkbx);\n\t\t}\n\t\t\tbreak;\n\t\tcase 10://SMS\n\t\t{\n\t\t\tlet ar = additional.crEl(\"textarea\");\n\t\t\tar.placeholder = \"Treść wysyłanego sms\";\n\t\t\tadditional.crEl(\"span\", null, \"Dostępne zmienne:<br>\" +\n\t\t\t\t\"[dziecko-imie][dziecko-nazw][dziecko-tel][dziecko-email]<br>\" +\n\t\t\t\t\"[rodzic-imie][rodzic-nazw][rodzic-tel][rodzic-email]<br>\" +\n\t\t\t\t\"[znak][data]\");\n\t\t\tlet div = additional.crEl(\"div\");\n\t\t\tfill(ar,provdata[\"content\"]);\n\n\t\t\tgen[\"f\"] = function(area) {\n\t\t\t\tlet data = {};\n\t\t\t\tdata[\"content\"] = area.value;\n\t\t\t\treturn data;\n\t\t\t}.bind(this,ar);\n\t\t}\n\t\tcase 12://lista zapisanych\n\t\t{\n\t\t\tfet(\"miejsca/\"+miejsceId+\"/grupy\").then(res=> {\n\t\t\t\tlet grupy = hat_embedded(res);\n\n\t\t\t\tlet div = additional.crEl(\"div\");\n\t\t\t\tlet showh = div.crEl(\"input/checkbox\");\n\t\t\t\tdiv.crEl(\"span\", null, \"Wyświetl godziny\");\n\t\t\t\tadditional.crEl(\"span\", null, \"Widoczne grupy:\");\n\t\t\t\tlet m = new Map();\n\t\t\t\tgrupy.forEach((d) => {\n\t\t\t\t\tlet div = additional.crEl(\"div\");\n\t\t\t\t\t/*map[\"gr-\"+d['id']] = */\n\t\t\t\t\tconst ch = div.crEl(\"input/checkbox\")\n\t\t\t\t\tm.set(d['id'], ch);\n\t\t\t\t\tch.checked = provdata[\"groups\"] != null && provdata[\"groups\"].includes(d['id']);\n\t\t\t\t\tdiv.crEl(\"span\", null, d['nazwa']);\n\t\t\t\t});\n\t\t\t\tfill(showh,provdata[\"showhours\"]);\n\n\t\t\t\tgen[\"f\"] = function(m,showh) {\n\t\t\t\t\tlet data = {};\n\n\t\t\t\t\tdata[\"showhours\"] = showh.checked;\n\t\t\t\t\tdata[\"groups\"] = [];\n\t\t\t\t\tm.forEach((v, k) => {\n\t\t\t\t\t\tif (v.checked) {\n\t\t\t\t\t\t\tdata[\"groups\"].push(k);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\treturn data;\n\t\t\t\t}.bind(this,m,showh);\n\t\t\t});\n\t\t}\n\t\tdefault:\n\t\t\tgen[\"f\"] = function() {\n\t\t\t\treturn {};\n\t\t\t};\n\t\t\tbreak;\n\t}\n\treturn gen;\n}\n\nconst parTypes = new Map([\n\t[0, null],\n\t[1, \"tekst\"],\n\t[2, \"dane rodzica\"],\n\t[3, \"dane dziecka\"],\n\t[4, \"wybór grupy\"],\n\t[5, \"harmonogram opłat\"],\n\t[6, \"płatność indywidualna\"],\n\t[7, \"checkbox z tekstem\"],\n\t[8, \"kod sms\"],\n\t[9, \"treść maila\"],\n\t[10, \"treść sms\"],\n\t[11, null],\n\t[12, \"lista zapisanych\"],\n\n]);"],"mappings":"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"}